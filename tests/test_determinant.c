#include "tests.h"

START_TEST(test_determinant_1) {
  matrix_t A;
  double C, RES = -27638.602925247917;
  s21_create_matrix(6, 6, &A);
  double arr1[] = {
      4.463532173194241,   4.322602217597369,  7.719391958902397,
      7.387101535714219,   0.9331966196599678, 0.23381371143947494,
      7.599184665789972,   1.5632863014902494, 3.535754489490907,
      2.247381356416436,   9.327782065876304,  6.55997923119852,
      1.143234842107918,   2.0502417634562033, 4.014471433173522,
      7.958848331671471,   3.8368171219422944, 4.21277664782264,
      5.8246292456837825,  0.891866252022282,  6.1116409723616805,
      5.938864100081287,   4.774209874895024,  5.442083754652327,
      3.5990724298595222,  8.094655458955554,  6.2776062158543855,
      5.298252477582164,   4.240736194633692,  5.459632439454948,
      3.7243940799510304,  1.6870998409839002, 7.918434581677961,
      0.14083653289443926, 2.2070700985996723, 7.456542937542982,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_2) {
  matrix_t A;
  double C, RES = -1098970.8417880293;
  s21_create_matrix(8, 8, &A);
  double arr1[] = {
      4.407349798067627,   3.192107015441128,   4.156212693864867,
      8.130749514074632,   8.890331013350249,   5.667283243119463,
      9.061891909699476,   4.961277810621755,   3.4685881848296916,
      7.745722766410909,   7.032082275273626,   1.4707896274328964,
      4.836648127893783,   5.963277344551849,   8.620893741499053,
      0.8343630306118496,  8.925426719907565,   6.556425573779185,
      9.199884530902432,   5.946972536161672,   0.20482163995241268,
      8.642746078870148,   0.25707115350978826, 8.271687231481149,
      7.608022508139304,   3.1847564167972484,  1.109167472082242,
      1.6453525033211345,  4.499863237512895,   2.1335563036618406,
      0.506248285270098,   8.037321535830987,   7.094929809788091,
      5.3261631207263855,  1.5313159519378061,  7.295671505939345,
      5.2375050444874764,  1.8518743791469672,  2.3871645901620786,
      4.101073061267281,   6.054402838913609,   5.40683666434338,
      4.4361748418969835,  9.169324489365561,   6.998846137892258,
      2.779117887350764,   3.6769857527965457,  4.081954524341594,
      5.615648100198827,   2.053305227027583,   0.8306145348660798,
      8.725931149721864,   5.0693265194087616,  8.212460717176773,
      2.4522190915706923,  7.452023014241582,   7.7982939246740814,
      0.17733128906136592, 2.911698857703117,   0.8889773279569735,
      1.6677211407064028,  9.029223933562635,   3.7115550759899474,
      8.119162448973293,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_3) {
  matrix_t A;
  double C, RES = 25121.89643834139;
  s21_create_matrix(5, 5, &A);
  double arr1[] = {
      0.7179207725866565, 7.385494163185727,  6.765696586594559,
      8.000197069991186,  4.914213137434499,  5.015937239474413,
      3.5009866629028843, 6.05896265532669,   1.413610520262202,
      9.845990235212806,  6.064902364219056,  9.008098078349159,
      0.2359518484410531, 2.0265420663099234, 8.271209902892908,
      3.7175135286364847, 8.042323003470642,  8.284953025082539,
      2.4435549140013046, 2.602644568264276,  7.391440709848228,
      7.693852649204148,  4.454718520415343,  7.524734856307252,
      6.273040980528876,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_4) {
  matrix_t A;
  double C, RES = -6718198.533618853;
  s21_create_matrix(9, 9, &A);
  double arr1[] = {
      1.9143681437566555,  9.098658118259818,  6.645534395271021,
      0.46721653802421875, 8.78059574325245,   7.389177001933217,
      8.300272485629012,   9.467592484160932,  7.523712967642804,
      2.113780954274699,   1.9170058574039064, 4.389428349697735,
      3.8030936826930852,  9.159498929635918,  3.731015212440038,
      8.594930937522266,   0.9451312781666161, 7.311593854307577,
      0.36537252467257686, 4.801815332572417,  2.749084524424676,
      1.6975719124794364,  9.821419435118102,  2.6459893890152393,
      8.820765721416674,   0.6439983865238647, 6.0907632290544855,
      7.102412280832053,   2.5293358243293254, 6.962536381378089,
      9.55935884478731,    6.521411847042104,  7.11990061565702,
      5.060390686951303,   6.354928779178105,  5.491733946721007,
      8.580791815918955,   3.2794928373253986, 0.8667135714927717,
      6.986741457059062,   1.737772178609812,  4.936093710223217,
      6.293908660647633,   2.801048877856029,  8.00585668288199,
      6.659611037255775,   5.415341599242903,  3.4066099670645262,
      4.17504403481424,    9.3327051448704,    9.767060519491183,
      5.537890788416882,   4.342207065783532,  0.7589789881997212,
      1.494585492327074,   1.2110780412213462, 5.82586519082096,
      7.13171646467636,    9.782615775761498,  7.006894661958976,
      6.240426222175317,   1.789154606351254,  5.406722301444254,
      9.552253805636642,   5.770356315466371,  0.859024249329318,
      0.06993093535377126, 5.970866654613015,  4.5580264693160455,
      5.478624467166374,   3.5750626060562634, 5.437872213656828,
      7.794412972856111,   9.210539582156917,  6.289683884277375,
      1.657572649205282,   2.5641078784611735, 2.4223786565575596,
      3.8366708148215145,  7.554454055528299,  3.896449204880303,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_5) {
  matrix_t A;
  double C, RES = -35823678.95833707;
  s21_create_matrix(9, 9, &A);
  double arr1[] = {
      8.307279219052608,    7.976660422202737,   2.8122192522437577,
      4.605749448038685,    1.605749250481736,   2.8586887870508106,
      3.7551763228364257,   9.385593595594008,   4.6630379124714665,
      0.48970048312525255,  8.228874445931986,   2.7934188075961224,
      3.4523596349388956,   0.13401996736746538, 1.1339071842676092,
      2.275653175938143,    7.778667753933805,   7.744381210974254,
      3.3570412069739426,   0.38815506420364226, 8.829680678840734,
      4.131211901994079,    7.854675144439926,   3.6253877256046905,
      1.2874500098587638,   3.398161112446456,   8.157547459601508,
      5.23671134440068,     3.7723094283609204,  6.715060441787184,
      4.09728737473692,     1.8184952397647813,  5.800682071761844,
      1.1427317708324813,   1.8928843418987344,  8.876595924978155,
      4.592929434159729,    1.0818314694251063,  7.797002851692652,
      1.6060601009522666,   4.185648707759679,   2.433443311843225,
      4.2228569012098625,   5.759337559578902,   8.802403429901261,
      6.654533730050877,    3.5988476003916343,  9.250951922271124,
      3.5352180785681537,   9.064117232238678,   1.9233576962488812,
      1.2336154503815189,   3.5986046994666783,  9.926635867010503,
      0.011467135262928686, 8.550949998576,      2.6216074079535434,
      6.178062696434806,    7.570942830881224,   7.526237485435043,
      9.613355512665335,    6.14902255752707,    0.23029201758399567,
      5.2013744440361425,   3.9827418862478776,  4.446173143507852,
      1.4768561789169492,   5.589912821715969,   6.550447880397038,
      3.0595331460249118,   1.8136237368094463,  1.2068980763216555,
      6.88919970686857,     6.20941118736369,    0.10058406461504722,
      5.305482415256005,    7.956572192945275,   2.1261436448821893,
      0.03974294794572918,  8.907598183050107,   9.418724760163816,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_6) {
  matrix_t A;
  double C, RES = 20.37978328916337;
  s21_create_matrix(3, 3, &A);
  double arr1[] = {
      3.979190942272489,  8.221368947698464, 7.462698653243547,
      6.8892903156100065, 6.429899107532819, 5.177694061786408,
      1.2290056111913241, 4.174044048388838, 3.270602935996039,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_7) {
  matrix_t A;
  double C, RES = -219.76912678295398;
  s21_create_matrix(4, 4, &A);
  double arr1[] = {
      2.9759308269150333, 9.171208392367374,  4.843865881322814,
      2.6717065919772187, 2.8283955303495163, 4.6543949735334085,
      6.550200421010001,  2.948992268774503,  6.1973549118458635,
      9.082659011309872,  1.9466681457827681, 2.9021836322120396,
      0.3201618755861258, 6.480651315853979,  8.853073669491565,
      1.4396838885220549,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_8) {
  matrix_t A;
  double C, RES = 1072328.1953746446;
  s21_create_matrix(8, 8, &A);
  double arr1[] = {
      4.436620389979057,  9.151318107888626,  7.263023155226057,
      5.29366390581171,   0.6224856492884215, 7.477805702096043,
      9.807571367637394,  9.824831864904297,  6.899462021333715,
      9.611355085878914,  6.207521533680417,  6.131611239960022,
      5.9389840598559065, 0.7152600174367568, 3.501242942376236,
      9.352719472623907,  5.412516937381886,  8.339107739984703,
      0.7600185181086,    0.5363278789880438, 3.5272921566888438,
      8.418014947305325,  7.436652307181373,  5.270854481377712,
      1.7771977105574965, 6.31052502315738,   1.9611081065779232,
      0.3798459801287488, 3.198750142889006,  7.64966534662741,
      1.2403343742302788, 3.0622942296370956, 7.952148314578847,
      7.742274279162991,  3.145477694229205,  8.779257055119613,
      9.144987141383549,  3.986809508062032,  3.4280816809401617,
      7.4875132878161885, 1.217179845926729,  4.938370868115965,
      5.646679126313447,  3.8351839407494306, 4.105660125274334,
      8.193383689729464,  5.5339260377215584, 5.888790695271988,
      9.31238572184612,   6.3030082105576275, 6.079698358625236,
      7.8339427772602095, 7.792827172221719,  1.5264304192559393,
      3.6512284697702206, 4.996532153616241,  9.834492705718974,
      8.968191578099294,  6.316820054749111,  2.2750627745375445,
      4.146754136035771,  2.5413435796269632, 7.642848450338962,
      9.071382444262435,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_9) {
  matrix_t A;
  double C, RES = 1425307.7794782077;
  s21_create_matrix(8, 8, &A);
  double arr1[] = {
      9.89224819848652,   2.0560329640451216,   4.883643040382351,
      4.19310739875181,   3.381419364158885,    5.83424407622534,
      5.279127461636828,  6.775313937889021,    5.476039157309084,
      7.63409506328558,   9.545931175868102,    8.86691541633614,
      5.441460584339822,  1.0802892615681623,   8.466808730425216,
      8.73705384059422,   9.998555376717414,    5.858095747815685,
      1.1156299228335809, 1.1949413899925483,   4.24418637075146,
      5.837873685403303,  7.848703967460952,    9.582014990761646,
      8.89357880224745,   6.863503524573118,    4.87111094319976,
      6.1177327934422,    8.097536240496698,    9.536344117052929,
      1.0263330525849375, 0.4612471856806396,   9.179454009549607,
      8.158348780483953,  9.505669756534912,    1.5638592838576906,
      3.967106886715544,  9.116644169629247,    7.720635255250949,
      4.796560082245231,  6.581314575804496,    2.3297834631680505,
      5.027298393888684,  8.870663833710708,    7.835651775627486,
      0.4196248487480231, 4.295278026990941,    2.045929608481063,
      3.622308143435923,  5.595030475812945,    7.01343110875888,
      5.584701411657969,  0.014186653832687936, 0.3180898038257687,
      9.39427998949194,   7.538537994757613,    6.5294823109593825,
      8.347910682603993,  7.279650732569263,    3.0783283217886126,
      6.866019704196977,  6.14022835473608,     8.335137106634416,
      3.242451942305068,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_10) {
  matrix_t A;
  double C, RES = -325.66083559725166;
  s21_create_matrix(4, 4, &A);
  double arr1[] = {
      1.4415081845247506, 6.726952286622186,  5.263913244602934,
      1.4108299265896704, 5.036994567778508,  4.262312463619421,
      9.76440196583962,   2.88744019478714,   0.42169059786936414,
      8.088065332170121,  5.400530248174093,  4.5695492236407205,
      7.334770316242242,  0.7927338151447111, 8.574257683591819,
      4.040259474098724,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_11) {
  matrix_t A;
  double C, RES = 1.5;
  s21_create_matrix(1, 1, &A);
  double arr1[] = {1.5};
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}

START_TEST(test_determinant_12) {
  matrix_t A;
  double C, RES = 0.0;  // Determinant of a zero matrix is 0
  s21_create_matrix(3, 3, &A);
  double arr1[] = {
      0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_13) {
  matrix_t A;
  double C,
      RES = 1.0;  // Determinant of a 1x1 matrix is the only element itself
  s21_create_matrix(1, 1, &A);
  double arr1[] = {1.0};
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_14) {
  matrix_t A;
  double C, RES = 1321.0;  // Determinant of a 2x2 diagonal matrix is the
                           // product of diagonal elements
  s21_create_matrix(2, 2, &A);
  double arr1[] = {
      1321.0,
      0.0,
      0.0,
      1.0,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_15) {
  matrix_t A;
  double C, RES = 0.0;  // Determinant of a 3x3 singular matrix with linearly
                        // dependent rows is 0
  s21_create_matrix(3, 3, &A);
  double arr1[] = {
      1.0, 2.0, 3.0, 2.0, 4.0, 6.0, 3.0, 6.0, 9.0,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_16) {
  matrix_t A;
  double C, RES = 0.0;  // Determinant of a 5x5 matrix with a row of zeros is 0
  s21_create_matrix(5, 5, &A);
  double arr1[] = {
      1.0, 2.0, 3.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 8.0,
      9.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 1.0, 2.0,
  };
  from_array_to_matrix(&A, arr1);
  ck_assert_int_eq(s21_determinant(&A, &C), OK);
  ck_assert_double_eq_tol(C, RES, 1e-7);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_uninitialized) {
  matrix_t A;
  s21_create_matrix(4, 4, &A);
  double C;
  ck_assert_int_eq(s21_determinant(NULL, &C), ERROR_MATR);
  ck_assert_int_eq(s21_determinant(NULL, NULL), ERROR_MATR);
  ck_assert_int_eq(s21_determinant(&A, NULL), ERROR_MATR);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_determinant_invalid) {
  matrix_t A;
  s21_create_matrix(4, 3, &A);
  double C;
  ck_assert_int_eq(s21_determinant(&A, &C), ERROR_MATR);
  s21_remove_matrix(&A);
}

Suite *test_determinant(void) {
  Suite *s = suite_create("\033[41m-=S21_DETERMINANT=-\033[0m" RAINBOW_COLORS);
  TCase *tc = tcase_create("s21_determinant_tc");

  srand(time(NULL));

  tcase_add_test(tc, test_determinant_1);
  tcase_add_test(tc, test_determinant_2);
  tcase_add_test(tc, test_determinant_3);
  tcase_add_test(tc, test_determinant_4);
  tcase_add_test(tc, test_determinant_5);
  tcase_add_test(tc, test_determinant_6);
  tcase_add_test(tc, test_determinant_7);
  tcase_add_test(tc, test_determinant_8);
  tcase_add_test(tc, test_determinant_9);
  tcase_add_test(tc, test_determinant_10);
  tcase_add_test(tc, test_determinant_11);
  tcase_add_test(tc, test_determinant_12);
  tcase_add_test(tc, test_determinant_13);
  tcase_add_test(tc, test_determinant_14);
  tcase_add_test(tc, test_determinant_15);
  tcase_add_test(tc, test_determinant_16);
  tcase_add_test(tc, test_determinant_uninitialized);
  tcase_add_test(tc, test_determinant_invalid);

  suite_add_tcase(s, tc);
  return s;
}
