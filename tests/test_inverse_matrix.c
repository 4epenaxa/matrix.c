#include "tests.h"

START_TEST(test_inverse_1) {
  matrix_t A, B, RES;
  s21_create_matrix(6, 6, &A);
  s21_create_matrix(6, 6, &RES);
  double arr1[] = {
      1.9547993990886803, 1.1502854956420632, 7.224488319875126,
      8.51600506064552,   1.852123221921007,  5.239723607393697,
      5.19033616767409,   8.72625623296947,   8.332963700519759,
      3.6596265818910054, 2.657445638811325,  1.0795433156022722,
      3.661892841750117,  8.637965689287006,  2.2691731938358384,
      3.2284786772368657, 1.2013250950140746, 3.2929688989145993,
      3.2176778710303466, 2.2028200074298954, 4.271655650346267,
      2.850711233684471,  8.232882850294063,  5.4327656144575815,
      0.4520813968794904, 5.608936491051242,  8.5234894797834,
      2.1483848773312695, 8.79985561674509,   8.42027794620333,
      7.017915783810987,  6.157312554773245,  2.4455533324234175,
      6.527878385654567,  3.7652651792922374, 4.118759791138392,
  };
  double arr3[] = {
      -0.5179233887371736, 0.03805911217872684,   -1.5866241873597027,
      -1.7644195518502952, 1.1865262452422787,    1.8190403240708324,
      0.1773691201526554,  0.012082142592262398,  0.7949083798173335,
      0.77375806180621,    -0.533886060296498,    -0.7934898544962381,
      -0.1408288814702768, 0.1022085455580013,    -0.6451091765378199,
      -0.7018594683942435, 0.4908507697484175,    0.5904273411010432,
      0.5199176134467183,  -0.020248528206264542, 1.3840848520161866,
      1.640317874086634,   -1.1728532845256625,   -1.5285731670462757,
      0.32570846614278354, 0.02382792852339223,   1.1541121806624424,
      1.5632105385006152,  -0.99899322761452,     -1.3629240937601834,
      -0.4208323938622846, -0.13328870565996415,  -1.350584108167423,
      -1.7624201984992964, 1.2570964621034924,    1.6476032602855293,
  };
  from_array_to_matrix(&A, arr1);
  from_array_to_matrix(&RES, arr3);
  ck_assert_int_eq(s21_inverse_matrix(&A, &B), OK);
  ck_assert_int_eq(s21_eq_matrix(&B, &RES), SUCCESS);
  s21_remove_matrix(&A);
  s21_remove_matrix(&B);
  s21_remove_matrix(&RES);
}
END_TEST

START_TEST(test_inverse_2) {
  matrix_t A, B, RES;
  s21_create_matrix(4, 4, &A);
  s21_create_matrix(4, 4, &RES);
  double arr1[] = {
      1.0216816125081558, 7.638608503669737,  1.8779249517822203,
      4.763427173386319,  6.7413572534288715, 9.815744686618713,
      4.019237900179321,  2.5245346216034887, 2.9341864803976843,
      7.56735343609421,   1.1440962105650483, 6.40383615351088,
      0.7666134945404439, 7.097413734936419,  8.447775955912686,
      2.319950556875834,
  };
  double arr3[] = {
      -0.35477228410326767,   0.10524186854935413,  0.22291049619887165,
      -0.0013953301198773164, 0.41406614666384733,  0.08134583621100014,
      -0.30780210144047604,   -0.08906228130266429, -0.23761036567880248,
      -0.04022605756451922,   0.13002868253521604,  0.17272323677971912,
      -0.2842933009972667,    -0.13715989290661101, 0.3945168087020355,
      0.07502501735243983,
  };
  from_array_to_matrix(&A, arr1);
  from_array_to_matrix(&RES, arr3);
  ck_assert_int_eq(s21_inverse_matrix(&A, &B), OK);
  ck_assert_int_eq(s21_eq_matrix(&B, &RES), SUCCESS);
  s21_remove_matrix(&A);
  s21_remove_matrix(&B);
  s21_remove_matrix(&RES);
}
END_TEST

START_TEST(test_inverse_3) {
  matrix_t A, B, RES;
  s21_create_matrix(5, 5, &A);
  s21_create_matrix(5, 5, &RES);
  double arr1[] = {
      9.94259584961474,   7.197817347026828,  3.895975929671797,
      5.3038439671099855, 7.942669459178354,  4.835285132269709,
      5.3092761534694155, 3.259816971137507,  7.775459369446763,
      8.404238768290623,  2.102958677597524,  5.62338133417338,
      3.7788720582408644, 2.339710192200503,  1.5556593323105257,
      1.866880971810919,  8.168378848017166,  1.9381362843746115,
      8.850704249232157,  8.63074822007923,   5.547890483681569,
      0.926961557042155,  2.7831496607368083, 2.6445412547481184,
      7.087479472397674,
  };
  double arr3[] = {
      0.16669448102459966,   0.12770607781283025,   -0.10426886339833549,
      -0.14194019366811145,  -0.1425068860105114,   0.0965012121355282,
      -0.30802106824987524,  0.061488692695090774,  0.19449800994214186,
      0.006756500851967405,  -0.19687991986785586,  0.18882179123482504,
      0.29093126951011095,   -0.1646686362907906,   0.13340035865268152,
      -0.026646923434247936, 0.5446726304139675,    -0.09244192897236504,
      -0.23126090228027704,  -0.3140959166156805,   -0.05585066875152603,
      -0.3370597685340566,   -0.006174859299209147, 0.2366219096667798,
      0.31657460673527477,
  };
  from_array_to_matrix(&A, arr1);
  from_array_to_matrix(&RES, arr3);
  ck_assert_int_eq(s21_inverse_matrix(&A, &B), OK);
  ck_assert_int_eq(s21_eq_matrix(&B, &RES), SUCCESS);
  s21_remove_matrix(&A);
  s21_remove_matrix(&B);
  s21_remove_matrix(&RES);
}
END_TEST

START_TEST(test_inverse_4) {
  matrix_t A, B, RES;
  s21_create_matrix(7, 7, &A);
  s21_create_matrix(7, 7, &RES);
  double arr1[] = {
      4.983565883322142,  9.008736241446208,  1.8523921071480551,
      6.415166964003015,  4.924483747846352,  6.032754032731709,
      3.8766066881787373, 6.559094290752906,  0.7663322002246116,
      9.993313158335505,  6.592740078867397,  2.896562587601994,
      4.061482005728733,  3.4078272115687156, 9.669342373747176,
      0.8435258311362813, 9.962740918776259,  6.89250081134105,
      1.0812006590842975, 7.709057913897373,  7.563670132798029,
      9.202817485312384,  7.054003554662409,  2.531375622237315,
      5.131632141052655,  4.516511641892757,  0.3974196862540327,
      3.3416032261302138, 3.9779223454776953, 3.921341353120595,
      7.187108190040161,  5.39345338335869,   5.690390177499699,
      4.420296731575975,  9.383176807133237,  9.433278597817313,
      6.698937239988837,  5.823383333183122,  8.418888507733039,
      2.9952624405196033, 4.717068281934189,  1.1840815651160033,
      6.486781699451299,  2.872637660718398,  1.090488494131354,
      2.2788061522446292, 6.033368617400068,  5.914521221003136,
      4.08916501114396,
  };
  double arr3[] = {
      0.05501525542227048,  0.08301804777754204,  0.08867553909146196,
      0.15999325445016324,  -0.1715467349986803,  -0.1747695010205362,
      0.02813887872300615,  1.4888928911998849,   1.303712776455059,
      0.2943355097926846,   0.781735813078356,    -1.1972929504432106,
      -2.0107110461227586,  -0.35164399204603797, 1.4359660170420674,
      1.5013788674803954,   0.2696331033038128,   0.7605082119859686,
      -1.2232947359163706,  -2.083240976294211,   -0.32249364758412524,
      -2.330782704719327,   -2.252392829141019,   -0.5158311916543158,
      -1.2949957422945333,  2.04751829858622,     3.4498301245449507,
      0.40182429788095825,  -0.31090314569500377, -0.12858445817775818,
      -0.2163888333854505,  -0.15571103256267488, 0.2752496268843632,
      0.3827235578523966,   0.1869744184493377,   0.4702306251732986,
      0.363336912751814,    0.12999824236370097,  0.08600673110911965,
      -0.39015474723707977, -0.5504845263979833,  -0.004657000363822511,
      -0.43867633630973407, -0.5285310222875664,  -0.0006393493183565082,
      -0.17876334646099287, 0.456612204806496,    0.5543264172142432,
      0.039878380957126786,
  };
  from_array_to_matrix(&A, arr1);
  from_array_to_matrix(&RES, arr3);
  ck_assert_int_eq(s21_inverse_matrix(&A, &B), OK);
  ck_assert_int_eq(s21_eq_matrix(&B, &RES), SUCCESS);
  s21_remove_matrix(&A);
  s21_remove_matrix(&B);
  s21_remove_matrix(&RES);
}
END_TEST

START_TEST(test_inverse_5) {
  matrix_t A, B, RES;
  s21_create_matrix(4, 4, &A);
  s21_create_matrix(4, 4, &RES);
  double arr1[] = {
      6.217702676375514, 0.3277041175610314, 6.573437716509629,
      8.652325132743533, 3.0629223146374276, 0.8857584218806316,
      8.35076909095084,  1.5728821134830238, 9.90475577113264,
      9.108256387246787, 2.9746365906979304, 8.36656477772557,
      2.033614822865992, 3.274777782250787,  2.3619486123364184,
      8.824489920272622,
  };
  double arr3[] = {
      0.14899664525876616,  -0.08703855771914049, 0.07593602724689043,
      -0.20257145001261634, -0.19265465750119748, 0.09702494404474438,
      0.06916629345067273,  0.1060251266476493,   -0.04340156984414997,
      0.15205173168818914,  -0.02849435549731899, 0.04246873404812867,
      0.04877468128263654,  -0.05664583575071479, -0.03554048688127813,
      0.10929069165355328,
  };
  from_array_to_matrix(&A, arr1);
  from_array_to_matrix(&RES, arr3);
  ck_assert_int_eq(s21_inverse_matrix(&A, &B), OK);
  ck_assert_int_eq(s21_eq_matrix(&B, &RES), SUCCESS);
  s21_remove_matrix(&A);
  s21_remove_matrix(&B);
  s21_remove_matrix(&RES);
}
END_TEST

START_TEST(test_inverse_6) {
  matrix_t A, B, RES;
  s21_create_matrix(1, 1, &A);
  s21_create_matrix(1, 1, &RES);
  double arr1[] = {
      1.4459913546857166,
  };
  double arr3[] = {
      0.6915670669534176,
  };
  from_array_to_matrix(&A, arr1);
  from_array_to_matrix(&RES, arr3);
  ck_assert_int_eq(s21_inverse_matrix(&A, &B), OK);
  ck_assert_int_eq(s21_eq_matrix(&B, &RES), SUCCESS);
  s21_remove_matrix(&A);
  s21_remove_matrix(&B);
  s21_remove_matrix(&RES);
}
END_TEST

START_TEST(test_inverse_7) {
  matrix_t A, B, RES;
  s21_create_matrix(5, 5, &A);
  s21_create_matrix(5, 5, &RES);
  double arr1[] = {
      8.349126518943363,  8.321497150538036,  5.164671673195764,
      4.975991648509501,  9.986905992771062,  8.58040248455166,
      7.023562390471739,  7.839497739818583,  8.14734501394676,
      2.186146692320095,  5.510049233198261,  6.0207990046020505,
      8.457992373950514,  9.771452613224325,  8.733184823686848,
      0.9595175624144716, 8.450891995189911,  9.266911664649117,
      6.296292170796037,  1.4622410881146468, 9.671424475937833,
      6.634128308233922,  8.929755582663601,  9.256835565314589,
      2.6701251553718293,
  };
  double arr3[] = {
      0.07268538082061078,  -0.23875893250550131, -0.11437045382709123,
      -0.04446943938386742, 0.3220460795996931,   0.008982103671453724,
      0.7933534721776547,   0.009410534126458935, 0.006789800035981367,
      -0.7176452941089968,  0.1256689355797706,   -1.4310825418026358,
      -0.20778939538714727, 0.22687536622206392,  1.257030676838006,
      -0.2266276694959546,  1.145682002359139,    0.2999975997971681,
      -0.1781108040613047,  -0.974041697564009,   0.07980996405330941,
      -0.2922118957688753,  0.04575612403146918,  0.0029359213210607533,
      0.1639899715765981,
  };
  from_array_to_matrix(&A, arr1);
  from_array_to_matrix(&RES, arr3);
  ck_assert_int_eq(s21_inverse_matrix(&A, &B), OK);
  ck_assert_int_eq(s21_eq_matrix(&B, &RES), SUCCESS);
  s21_remove_matrix(&A);
  s21_remove_matrix(&B);
  s21_remove_matrix(&RES);
}
END_TEST

START_TEST(test_inverse_8) {
  matrix_t A, B, RES;
  s21_create_matrix(6, 6, &A);
  s21_create_matrix(6, 6, &RES);
  double arr1[] = {
      1.5395185836501266, 2.743208791375914,   5.179196872698729,
      7.621078092813152,  9.098625829158827,   2.728019449025893,
      8.273110340983763,  9.12742225666757,    0.09409836344269157,
      9.352339801135562,  0.7363209583929652,  3.173195612686037,
      7.864949212797223,  8.515423963231546,   1.4014712679444834,
      6.077993538866761,  1.5299298375964974,  9.93228838114778,
      9.344295557184115,  6.578323428148081,   6.735515042592788,
      2.775173044703404,  5.957031633019753,   7.720952217418692,
      4.460002605365568,  2.5503176012481927,  8.159970566136524,
      3.2781409876775633, 7.177251801808729,   9.200772304474366,
      5.779987195901768,  5.9796055845521705,  8.92279901182892,
      6.76069356657069,   0.29497575839876666, 7.499702772632255,
  };
  double arr3[] = {
      -0.33105290689472266, 0.4604435912770649,    -0.34392608867654745,
      -0.10862041856466023, 0.543027622967876,     -0.17328769050219764,
      0.4216112405643072,   -0.586523803103542,    0.43485294827777243,
      0.3672289297960993,   -0.8809015877463671,   0.22154532931992027,
      0.059672077309192974, -0.10981791418890101,  -0.030272261104092462,
      0.09182608263982352,  -0.13997961807395637,  0.14204506396559335,
      -0.10810440422151374, 0.2812806398898771,    -0.15472058097018565,
      -0.23145479270807487, 0.3352364510790825,    -0.04777536082502242,
      0.11308099140477201,  -0.07197734304338876,  0.04632406308955562,
      0.08312586988259726,  -0.07269583660144202,  -0.06842216994459228,
      -0.05900563428934832, -0.007295558252281162, 0.09201785111128408,
      -0.11295519629503907, 0.151042510532222,     -0.03298999493312855,
  };
  from_array_to_matrix(&A, arr1);
  from_array_to_matrix(&RES, arr3);
  ck_assert_int_eq(s21_inverse_matrix(&A, &B), OK);
  ck_assert_int_eq(s21_eq_matrix(&B, &RES), SUCCESS);
  s21_remove_matrix(&A);
  s21_remove_matrix(&B);
  s21_remove_matrix(&RES);
}
END_TEST

START_TEST(test_inverse_9) {
  matrix_t A, B, RES;
  s21_create_matrix(4, 4, &A);
  s21_create_matrix(4, 4, &RES);
  double arr1[] = {
      8.340723747965304,  1.372396936057393,   7.608842910093571,
      7.724489378918692,  0.03679405026009111, 3.256213894581024,
      2.6625786940802008, 6.150353049856157,   8.108226997295985,
      4.100666094591505,  4.409348675053129,   3.4486731510436517,
      8.699317987272075,  6.826001809163862,   3.8598381269771687,
      8.003502524594204,
  };
  double arr3[] = {
      0.060634899377704034, -0.22333984186600758,  -0.11043518660024593,
      0.1606921595072634,   -0.20089786007498922,  0.2026700565803284,
      0.3065073945785838,   -0.09392173416278297,  -0.011447359968018678,
      0.26900501422837453,  0.41006734988172056,   -0.3723668543484693,
      0.11095540224358807,  -0.059828516084862185, -0.3391393715510598,
      0.20996726247947475,
  };
  from_array_to_matrix(&A, arr1);
  from_array_to_matrix(&RES, arr3);
  ck_assert_int_eq(s21_inverse_matrix(&A, &B), OK);
  ck_assert_int_eq(s21_eq_matrix(&B, &RES), SUCCESS);
  s21_remove_matrix(&A);
  s21_remove_matrix(&B);
  s21_remove_matrix(&RES);
}
END_TEST

START_TEST(test_inverse_10) {
  matrix_t A, B, RES;
  s21_create_matrix(7, 7, &A);
  s21_create_matrix(7, 7, &RES);
  double arr1[] = {
      4.149434786187993,   4.773711167012973,   2.0328987527190745,
      7.898475478628261,   4.412245571976193,   0.9259110410373408,
      4.0572599548535795,  5.498714141803406,   4.555072854385798,
      1.427532683010189,   2.993220287807633,   9.852213324290144,
      0.34598186157535893, 9.160022330893321,   8.75281760295183,
      8.431400880377998,   0.09496973835939772, 9.8559916659133,
      8.967660715241125,   2.3788979548856766,  1.5578578254355193,
      4.9663488890919645,  3.9211402265484936,  8.61939126250404,
      8.313266317479949,   7.227181306350266,   4.518648800732283,
      9.430521773957626,   7.147949214418918,   9.253745738607108,
      3.7308194120730946,  6.72218569734914,    6.630038916593985,
      4.32429763373654,    0.3323179457929565,  1.5877912154951923,
      1.4688864950134137,  9.490257186056414,   6.6076894333982175,
      1.833891610398278,   6.421606496893899,   5.713963920884827,
      9.713091450017755,   0.1907389020179403,  8.869382089210053,
      0.8303411871210795,  4.464590264108854,   0.08761334832182396,
      8.52972832521405,
  };
  double arr3[] = {
      0.06903206436178289,   0.13998384971670835,  0.1454023171570553,
      -0.500901937659244,    -0.08022965418277893, 0.33344310188752807,
      0.1238367896527376,    0.2932441573897248,   0.13827859559876146,
      -0.2633237675996585,   -0.26134213574467796, 0.2271155232301786,
      0.07894749240479006,   -0.01268115349387715, -0.1433212962212174,
      -0.3231638545133539,   -0.14632234833023602, 0.7127420320814298,
      0.14500215012930712,   -0.5067253278436549,  -0.012271965675666394,
      0.05151590489554688,   -0.13048043451983596, 0.08076709682448191,
      0.16870687698233336,   -0.09328780180153703, -0.08587708785720403,
      -0.024494034789110188, -0.43296511831854406, -0.2645692605920145,
      0.09103902124730663,   0.8439889405993307,   0.0023824156807708153,
      -0.5512973855065559,   -0.09046805256620694, -0.056221948848433935,
      0.33529767390202203,   0.18925162236596507,  -0.7366546109478177,
      -0.10160813588733594,  0.6623435115723892,   0.006816440709281003,
      0.2860449113327791,    0.3212731554064849,   -0.0649948303038858,
      -0.6154985331426298,   -0.05561664209900133, 0.4355488000907537,
      0.038930836698704126,
  };
  from_array_to_matrix(&A, arr1);
  from_array_to_matrix(&RES, arr3);
  ck_assert_int_eq(s21_inverse_matrix(&A, &B), OK);
  ck_assert_int_eq(s21_eq_matrix(&B, &RES), SUCCESS);
  s21_remove_matrix(&A);
  s21_remove_matrix(&B);
  s21_remove_matrix(&RES);
}
END_TEST

START_TEST(test_inverse_uninitialized) {
  matrix_t A, C;
  s21_create_matrix(4, 4, &A);
  ck_assert_int_eq(s21_inverse_matrix(NULL, &C), ERROR_MATR);
  ck_assert_int_eq(s21_inverse_matrix(NULL, NULL), ERROR_MATR);
  ck_assert_int_eq(s21_inverse_matrix(&A, NULL), ERROR_MATR);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_inverse_invalid) {
  matrix_t A, C;
  s21_create_matrix(4, 3, &A);
  ck_assert_int_eq(s21_inverse_matrix(&A, &C), ERROR_CALC);
  s21_remove_matrix(&A);
}
END_TEST

START_TEST(test_inverse_det_0) {
  matrix_t A, C;
  s21_create_matrix(4, 4, &A);
  ck_assert_int_eq(s21_inverse_matrix(&A, &C), ERROR_CALC);
  s21_remove_matrix(&A);
}
END_TEST

Suite *test_inverse(void) {
  Suite *s = suite_create("\033[41m-=S21_INVERSE=-\033[0m" RAINBOW_COLORS);
  TCase *tc = tcase_create("s21_inverse_tc");

  srand(time(NULL));

  tcase_add_test(tc, test_inverse_1);
  tcase_add_test(tc, test_inverse_2);
  tcase_add_test(tc, test_inverse_3);
  tcase_add_test(tc, test_inverse_4);
  tcase_add_test(tc, test_inverse_5);
  tcase_add_test(tc, test_inverse_6);
  tcase_add_test(tc, test_inverse_7);
  tcase_add_test(tc, test_inverse_8);
  tcase_add_test(tc, test_inverse_9);
  tcase_add_test(tc, test_inverse_10);
  tcase_add_test(tc, test_inverse_uninitialized);
  tcase_add_test(tc, test_inverse_invalid);
  tcase_add_test(tc, test_inverse_det_0);

  suite_add_tcase(s, tc);
  return s;
}
